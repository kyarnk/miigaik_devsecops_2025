# Уязвимое приложение, в котором специально создана sql-инъекция, работающая по временному интервалу

# Уязвимое веб-приложение "Список Задач Дедушки"

Это простое веб-приложение на Flask, демонстрирующее **уязвимость SQL-инъекции, зависящую от времени**. Приложение отображает список задач из временной базы данных SQLite и позволяет пользователю искать задачи.

## Особенности

*   Отображение списка предопределенных задач.
*   Поиск задач по текстовому запросу.
*   **Уязвимость:** Приложение намеренно содержит уязвимость к SQL-инъекции в функции поиска, которая активна только в определенные часы по московскому времени.
*   **Секретные данные:** В базе данных есть одна "секретная" задача, которая обычно скрыта, но может быть извлечена с помощью SQL-инъекции.

## Уязвимость: Time-Based SQL Injection

*   **Где:** Параметр `search` в GET-запросе к эндпоинту `/dedushka`.
*   **Когда:** Уязвимость активна, когда функция `is_vulnerable()` возвращает `True`. Это происходит в следующие часы (по времени сервера, настроенному на `Europe/Moscow`):
*   06:00 - 06:59
*   09:00 - 09:59
*   12:00 - 12:59
*   15:00 - 15:59
*   18:00 - 18:59
*   21:00 - 21:59
*   **Как:** В "уязвимые" часы введенный пользователем поисковый запрос напрямую вставляется в SQL-запрос с использованием f-строки (`f"SELECT * FROM tasks WHERE task LIKE '%{user_filter}%'"`), что позволяет выполнить произвольный SQL-код. В "безопасные" часы используется параметризованный запрос, и результаты фильтруются, чтобы скрыть секретные задачи (`is_secret = 0`).
*   **Цель:** Извлечь секретную задачу (ID 11), которая содержит флаг.
*   **Пример эксплуатации (в уязвимые часы):**
*   `http://<host>:5000/dedushka?search=' OR 1=1 --` (может показать все задачи, включая секретную)
*   `http://<host>:5000/dedushka?search=' UNION SELECT id, task, is_secret FROM tasks WHERE is_secret = 1 --` (попытка напрямую выбрать секретную задачу)

## Запуск приложения

1.  **Сохраните код** в файл (например, `app.py`).
2.  **Запустите приложение из командной строки:**
3.  Приложение будет доступно по адресу `http://0.0.0.0:5000` (или `http://127.0.0.1:5000`).

## Использование

*   Откройте веб-браузер и перейдите по адресу `http://127.0.0.1:5000/dedushka`.
*   Вы увидите список задач (кроме секретных, если сейчас "безопасное" время).
*   Используйте поле поиска для фильтрации задач.
*   Попробуйте использовать SQL-инъекции в поле поиска в "уязвимые" часы, чтобы найти скрытый флаг.

## База данных

Приложение использует временную базу данных SQLite (`:memory:`), которая создается и заполняется при каждом запуске. Данные не сохраняются между перезапусками.
